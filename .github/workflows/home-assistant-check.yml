---
name: Home Assistant Config CI

# Controls when the action will run. Triggers the workflow on push or pull request
# events but only for the main branch
on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main, dev ]
  schedule:
    - cron: 0 18 * * *


jobs:
  yamllint:
    runs-on: ubuntu-latest
    steps:
      - name: Getting config from Github
        uses: actions/checkout@v2
      - name: Run linting
        uses: frenck/action-yamllint@v1.0.1

  home-assistant:
    name: "Home Assistant Configuration Check for version ${{ matrix.version }}"
    # needs: [yamllint] // To be uncommented when yamllint is fixed
    runs-on: ubuntu-latest
    strategy:
      matrix:
        version: ["stable", "beta", "dev"]
    steps:
      - name: Getting config from Github
        uses: actions/checkout@v2
      - name: Run Home Assistant Configuration Check
        uses: frenck/action-home-assistant@v1.0.0
        with:
          secrets: ./.stubs/secrets.yaml
          version: "${{ matrix.version }}"
